title = "Edit Job Posting"
url = "/mycompany/job/:job_id/edit"
layout = "default"

[session]
security = "user"
allowedUserGroups[] = "admin_company"
redirect = "home"

[jobPostEdit]
[master]
==
function onEnd()
{
    $this['btnSave'] = 'Save';
}
==
<section class="dtl-acc dtl-pp">
    <div class="container">
        <div class="row my-5 justify-content-center">
            <div class="col-lg-8 col-md-10">
                <div class="text-center">
                    <div class="title-list text-start">Edit Job</div>

                    <form
                        data-request="jobPostEdit::onSave"
                        data-request-success="$('#job_posted').modal('show');"
                        data-browser-validate
                        action=""
                        method="POST"
                        enctype="multipart/form-data"
                        id="form-job">
                        <div class="group-li mb-3">
                            <label for="position">Position / Job Title</label>
                            <input type="text" name="title" value="{{ job.title }}" required class="form-control form-th" placeholder="Job Title">
                        </div>
                        <div class="group-li mb-3">
                            <label for="ref_job_type_id">Job Type</label>
                            <select
                                name="ref_job_type_id"
                                id="ref_job_type_id"
                                class="form-select form-th custom-select2"
                                required>
                                <option value>Select Job Type</option>
                                {% for item in master.jobTypes() %}
                                <option value="{{ item.id }}" {% if item.id == job.ref_job_type_id %} selected {% endif %}>{{ item.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="group-li form-check ps-0">
                                    <label for="">Minimum Working Experience & People Required</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="group-li mb-3">
                                    <input class="form-check-input check-req-input" data-error="#error-level_experiences" data-req="#freshgrad_number" name="level_experiences[]" disabled required type="checkbox" value="freshgrad_number" id="fresh_graduate" {% if job.freshgrad_number > 0 %} checked {% endif %}>
                                    <label class="form-check-label text-blue font-weight-500" for="fresh_graduate">
                                        Fresh Graduate (0 Year Experience)
                                    </label>
                                    <input type="number" min="1" max="999" name="freshgrad_number" id="freshgrad_number" disabled {% if job.freshgrad_number > O %} value="{{ job.freshgrad_number }}" {% endif %} class="form-control form-th mt-2" placeholder="People Required for This Working Experience">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="group-li mb-3">
                                    <input class="form-check-input check-req-input" data-req="#junior_number" name="level_experiences[]" disabled type="checkbox" value="junior_number" id="junior" {% if job.junior_number > 0 %} checked {% endif %}>
                                    <label class="form-check-label text-blue font-weight-500" for="junior">
                                        Junior (1-3 Years Experience)
                                    </label>
                                    <input type="number" min="1" max="999" name="junior_number" id="junior_number" disabled {% if job.junior_number > O %} value="{{ job.junior_number }}" {% endif %} class="form-control form-th mt-2" placeholder="People Required for This Working Experience">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="group-li">
                                    <input class="form-check-input check-req-input" data-req="#middle_number" name="level_experiences[]" disabled type="checkbox" value="middle_number" id="middle" {% if job.middle_number > 0 %} checked {% endif %}>
                                    <label class="form-check-label text-blue font-weight-500" for="middle">
                                        Middle (3-5 Years Experience)
                                    </label>
                                    <input type="number" min="1" max="999" name="middle_number" id="middle_number" disabled {% if job.middle_number > O %} value="{{ job.middle_number }}" {% endif %} class="form-control form-th mt-2" placeholder="People Required for This Working Experience">
                                    <label id="error-level_experiences"></label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="group-li">
                                    <input class="form-check-input check-req-input" data-req="#senior_number" name="level_experiences[]" disabled type="checkbox" value="senior_number" id="senior" {% if job.senior_number > 0 %} checked {% endif %}>
                                    <label class="form-check-label text-blue font-weight-500" for="senior">
                                        Senior (More than 5 Years Experience)
                                    </label>
                                    <input type="number" min="1" max="999" name="senior_number" id="senior_number" disabled {% if job.senior_number > O %} value="{{ job.senior_number }}" {% endif %} class="form-control form-th mt-2" placeholder="People Required for This Working Experience">
                                </div>
                            </div>
                        </div>
                        <div class="group-li mb-3">
                            <label for="description">Job Description</label>
                            <textarea name="description" id="editor" required placeholder="Your Job Description" rows="5">{{ job.description }}</textarea>
                        </div>
                        <!-- <div class="group-li">
                            <label for="">Job Qualification</label>
                            <div id="qualifications-container" class="multiple-select-content">
                                {% if not job.qualifications %}
                                    {% partial 'mycompany/job/form-item-qualification' %}
                                {% else %}
                                    {% for item in job.qualifications %}
                                    {% partial 'mycompany/job/form-item-qualification' text=item.name value=item.id %}
                                    {% endfor %}
                                {% endif %}
                            </div>
                            <span id="error-qualifications"></span>
                        </div>
                        <div class="text-end mb-1">
                            <a href="#"
                                data-request="jobPostEdit::onAddItem"
                                data-request-update="'mycompany/job/form-item-qualification': '@#qualifications-container'"
                                data-request-success="refreshEle()"
                                class="forgot-pass">+add more Qualifications</a>
                        </div> -->
                        <div class="row">
                            <div class="col-md-6">
                                <div class="group-li mb-3">
                                    <label for="">Job Location (Province)</label>
                                    <select name="province_code" id=""
                                        class="form-select form-th custom-select2"
                                        data-handler="master::onSearchLocation"
                                        data-minimum-input-length="2"
                                        data-ajax--delay="300"
                                        required
                                    >
                                        <option value="">Choose Province</option>
                                        {% if job.province_code %}
                                            <option selected value="{{ job.province_code }}">{{ job.province.name }}</option>
                                        {% endif %}
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="group-li mb-3">
                                    <label for="">Job Location (City)</label>
                                    <select name="city_code" id="city_code"
                                        class="form-select form-th custom-select2"
                                        {% if not job.city_code %} disabled {% endif %}
                                        required
                                    >
                                        {% partial 'select-options' defaultText='Choose City' selected={value: job.city_code, label: job.city.name} %}
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="group-li mb-3">
                            <label for="">Skill Required</label>
                            <select name="skills[]" id=""
                                class="form-select form-th custom-select2"
                                data-handler="master::onSearchSkill"
                                data-minimum-input-length="2"
                                data-ajax--delay="300"
                                multiple="multiple"
                                required
                            >
                            {% for skill in master.skills() %}
                            <option value="{{ skill.id }}" {% if skill.id in job.skills.pluck('id') %} selected {% endif %}>{{ skill.name }}</option>
                            {% endfor %}
                            </select>
                        </div>
                        <div class="row">
                            <div class="col-md-5">
                                <div class="group-li mb-3">
                                    <label for="description">Monthly Salary Range</label>
                                    <input type="text" data-rule-number="true" data-rule-minlength="7" data-rule-maxlength="12" name="min_salary" value="{{ job.min_salary }}" class="form-control form-th mt-2" placeholder="Min Salary">
                                </div>
                            </div>
                            <div class="col-md-2 d-flex justify-content-center align-items-center">
                                <div class="group-li">
                                    <label for="description">to</label>
                                </div>
                            </div>
                            <div class="col-md-5">
                                <div class="group-li mb-3">
                                    <label for="description"></label>
                                    <input type="text" data-rule-number="true" data-rule-minlength="7" data-rule-maxlength="12" name="max_salary" value="{{ job.max_salary }}" class="form-control form-th mt-2" placeholder="Max Salary">
                                </div>
                            </div>
                        </div>
                        <div class="group-li mb-3">
                            <input class="form-check-input" type="checkbox" value="1" name="is_display_salary" id="is_display_salary" {% if job.is_display_salary %} checked {% endif %}>
                            <label class="form-check-label text-blue font-weight-500" for="is_display_salary">
                                Display salary in the job post
                            </label>
                        </div>
                        <div class="group-li mb-3">
                            <label for="process">Process</label>
                            <input type="number" name="cv_days_processed" value="{{ job.cv_days_processed }}" required class="form-control form-th" placeholder="How long do you process CV?">
                        </div>
                        <div class="group-li form-check mb-3">
                            <input class="form-check-input" type="checkbox" value="true" id="is_placement" name="is_placement" {% if job.placement_id %} checked {% endif %}>
                            <label class="form-check-label" for="is_placement">
                                Is it for your Client?
                            </label>
                        </div>
                        <div class="group-li mb-3 hide" id="container_placement_id">
                            <label for="placement_id">Client</label>
                            <select
                                name="placement_id"
                                id="placement_id"
                                class="form-select form-th custom-select2">
                                <option value>Select your Client</option>
                                {% for item in client_divisions %}
                                <option value="{{ item.id }}" {% if item.id == job.placement_id %} selected {% endif %}>{{ item.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="row mt-5">
                            <div class="col">
                                <a class="btn btn-outline-secondary w-100 py-2" href="{{ url('mycompany/profile') }}">Cancel</a>
                            </div>
                            <div class="col">
                                <button data-attach-loading class="btn btn-yellow w-100 py-2">Save Changes</a>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Modal Add Work Culture -->
{% partial 'mycompany/job/modal-job-posted' %}

{% put scripts %}
<script src="{{ 'assets/vendor/ckeditor5/build/ckeditor.js'|theme }}"></script>
<script src="{{ 'assets/js/ckeditor.js'|theme }}"></script>
<script src="{{ 'assets/modules/company/form-job.js'|theme }}"></script>
{% endput %}

